function J = get_J(subIm, BB, i_c, j_c)
%subIm è un candidato, e la relativa BB

%     i_c = round(BB(3)/2 + BB(1));
%     j_c = round(BB(4)/2 + BB(2));
%     
    np = (size(subIm,1) * size(subIm,2));
    
    J = zeros(np, 2);
    t=1;
    s=min(size(subIm,1) , size(subIm,2));
    
    % i o x
    for i = 1 : size(subIm,1)
       % j o y
       for j = 1 : size(subIm,2)
           
           i_n_H = (i - i_c ) ;
           j_n_H = (j - j_c ) ;
       
           J(t,1) = gaussian_kernel_gradient_i(i_n_H ,j_n_H, s) ;
           J(t,2) = gaussian_kernel_gradient_j(i_n_H ,j_n_H, s) ;
           
           %J(t,1) = (3/2)*(i_n_H);
           %J(t,2) = (3/2)*(j_n_H);
           
           t=t+1;
           
       end
    end

end